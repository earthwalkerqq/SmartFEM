# FEMModalAI: Модульная система для модального анализа и анализа колебаний конструкций методом конечных элементов с интеграцией машинного обучения для прогнозирования конечного результата.

# Цели проекта

1. Реализация прочностного анализа конструкций (статический FEM).

2. Разработка динамического/модального анализа (собственные формы, вынужденные колебания).

3. Интеграция машинного обучения для прогнозирования результатов и ускорения расчётов.

## Описание проекта

Этот проект представляет собой модульную систему, объединяющую:

- **Модальный анализ механических конструкций** методом конечных элементов (FEM/МКЭ)
- **Модуль машинного обучения (ML)** для интеллектуального анализа результатов

Система предназначена для:
- Расчёта **собственных частот** и **форм колебаний**
- **Быстрого предсказания** характеристик колебаний по параметрам конструкции
- **Инверсного проектирования**: подбор параметров конструкции под заданные модальные характеристики
- **Классификации** типов колебаний по формам собственных мод

---

## Архитектура проекта при использовании NetGen

[STEP файл]
     ↓
[PythonOCC → geometry.json]
     ↓
[mesh_generator (Netgen)]
     ↓
[mesh.json] → [FEM-модуль на C/C++]
     ↓
[Результаты → ML-модуль на Python]

Модуль расчета методом конечных элементов(FEM-модуль) реализуется на C/C++, ML-модуль реализуется отдельно на Python. Обмен данными происходит через json или csv (алтернативный метод - использовать REST API. Реализуется Python REST-сервер, а клиент, в виде FEM-модуля, отправляет параметры и получает результат работы ML модуля). Для интеграции проекта с CAD/CAE необходимо написать вспомогательный Python-скрипт с использованием pythonocc/cadquery/FreeCAD. Далее скрипт экспортирует json/csv файл в FEM-модуль. После получения файла с параметрами CAD-модели необходимо реализовать модуль генерации КЭ сетки. Предлагается использовать open-source генератор 3д и 2д сеток NetGen. Netgen умеет напрямую загружать STEP/STP-файлы через OpenCascade и генерировать 3D-сетку без промежуточного JSON, однако, чтобы добиться разделение модулей и гибкости/настраиваимости генерации сетки, был выбран путь с парсингом CAD-модели в json файл. Далее сетка передается FEM-модулю для расчета.

## Архитектура проекта при использовании gmsh

[STEP файл]
     ↓
[mesh_generator (gmsh)]
     ↓
[mesh.json] → [FEM-модуль на C/C++]
     ↓
[Результаты → ML-модуль на Python]

Модуль расчета методом конечных элементов(FEM-модуль) реализуется на C/C++, ML-модуль реализуется отдельно на Python. Обмен данными происходит через json или csv (алтернативный метод - использовать REST API. Реализуется Python REST-сервер, а клиент, в виде FEM-модуля, отправляет параметры и получает результат работы ML модуля). Для интеграции проекта с CAD/CAE необходимо написать модуль gmsh генератором сеток, который напрямую работает с CAD/CAE программами. Основные преимущества над NetGen: больше контроля и поддержка других типов КЭ (помимо тетрайдера). Далее сетка передается FEM-модулю для расчета. 

Когда может пригодиться первоначальный парсинг step/stl -> json:
1. Нужно отделить CAD от генерации сетки

2. Ты создаёшь управляющий слой, где Gmsh читает .json с настройками (например, где задавать более мелкую сетку)

3. Тебе нужно передать структурированную информацию о конструкции в ML/FEM модуль


# Конвертация STEP → JSON для FEM-модуля

Этот шаг предназначен для извлечения параметров конструкции из CAD-модели в формате `.STEP` и преобразования их в структурированный `.json` файл. Этот файл затем будет использован в FEM-модуле для конечного элементного анализа.

## Модули:

1. CAD-парсер: извлечение геометрии из STEP/STP и экспорт в JSON

2. Генератор КЭ-сетки: на основе Netgen/Gmsh, управляется параметрами из JSON

3. FEM-модуль (C/C++): расчёт частот, форм колебаний, напряжений и деформаций

4. ML-модуль (Python): обучение и применение интеллектуальных моделей

5. Интерфейс обмена: через .json, .csv или REST API

## FEM-модуль

### Основные функции:
- Построение геометрии модели (балки/рамы/пластины) в CAD-CAE программах
- Парсинг из step/stp формата параметры модели в json
- Генерация КЭ-сетки на основе переданного json файла
- Построение глобальных матриц жесткости и масс
- Нахождение значений перемезений и деформаций в узлах модели
- Решение обобщённой собственной задачи:
- Расчет собственных частот и форм колебаний
- Визуализация результатов средствами OpenGL/Qt
- Тестирование полученных результатов 
- Экспорт результатов в `.json` / `.csv` для ML-модуля

#### Основные задачи модуля прочностного анализа
- Разработка модуля геометрии и сетки (стержни, балки, пластины).
- Формулировка матриц жёсткости элементов и сборка глобальной матрицы \(K\).
- Учёт граничных условий и нагрузок.
- Решение системы уравнений \(K u = F\).
- Постобработка: деформации, напряжения, эпюры усилий.

#### Дополнительные задачи
- Нелинейные нагрузки (температурные, контактные).
- Верификация на учебных примерах (балка, рама).
- Экспорт данных для модулей 2 и 3.

#### Основные задачи модуля динамического анализа
- Формулировка уравнений движения:  
  \( M \ddot{u}(t) + C \dot{u}(t) + K u(t) = F(t) \).
- Построение матрицы масс (консистентная и лумпированная).
- Решение задачи собственных значений: \((K - \omega^2 M) \phi = 0\).
- Вычисление собственных частот и форм колебаний.
- Реализация временной интеграции (метод Ньюмарка, Рунге–Кутты).
- Анализ вынужденных колебаний, построение АЧХ.

#### Дополнительные задачи
- Сейсмический и ударный анализ.
- Построение спектров отклика.
- Передача данных модулю 3 для обучения ML.


### Используемые технологии:
- Языки программирования: C/C++, Python
- Библиотеки: NetGen, pythonocc/cadquery/FreeCAD, OpenMP, OpenGL/Qt


## ML-модуль

### Основные задачи:
- Обработка данных, полученных из МКЭ
- Обучение моделей ML по разным задачам:

## Идеи для ML-модуля

1. Reductions & Model Order Reduction (ROM)

- Идея: построить ML-модель, которая сильно ускоряет вычисления, заменяя FEM-анализ на "приближение".

2. Feature Importance / Sensitivity Analysis

- Идея: использовать ML-модели (RF, SHAP, Permutation Importance), чтобы: определить, какие параметры влияют сильнее всего на частоты и формы, создать интерпретируемые модели

3. Предсказание деградации и изменений форм (damage prediction)

- Идея: имитировать "повреждения" (трещины, потерю жесткости) и обучить модель: предсказывать изменения частот/мод, распознавать местоположение повреждений, может быть основой для систем мониторинга технического состояния (SHM)

4. Zero-shot / Few-shot предсказания

- Идея: создать модели, способные делать разумные предсказания на новых типах конструкций, где нет достаточного количества данных.

#### 1. Регрессия
**Цель:** предсказание собственных частот конструкции по ее параметрам  
**Модели:** `Random Forest`, `XGBoost`, `MLP`, `LightGBM`

#### 2. Инверсная задача
**Цель:** определение параметров конструкции по заданным частотам  
**Методы:** нейросети, оптимизация, генеративные модели

#### 3. Классификация
**Цель:** автоматическое определение типа колебаний по форме мод  
**Модели:** `SVM`, `Decision Tree`, `kNN`, `CNN` (если формы представлены в виде изображений)

### Используемые технологии:
- Язык программирования: Python
- ML-фреймворки: `scikit-learn`, `XGBoost`, `pandas`, `TensorFlow` / `PyTorch` (по необходимости)

## Пример структуры проекта

src/
| README.md
├── cad_parser/
│   └── convert_step_to_json.py
├── mesh_generator/
│   └── meshgen.cpp
├── fem_solver/
│   ├── fem.cpp
│   └── solver.h
├── ml_module/
│   └── train_predict.py
├── data/
│   ├── geometry.json
│   ├── mesh.json
│   └── results.json
├── docs/
│   └── README.md
└── examples/
    └── beam_example.step

## 🚀 Цель проекта

Создание модульного программного комплекса, выполняющего:

- модальный анализ конструкций методом конечных элементов (МКЭ)
- генерацию конечно-элементной сетки из CAD-геометрии
- анализ и предсказание характеристик с использованием машинного обучения (ML)

Система открытая, расширяемая и направлена как на практическое применение, так и на исследовательские и образовательные цели.

---

## Востребованность проекта

Проект актуален на пересечении трёх направлений:

| Область                    | Актуальность и ценность                                           |
|----------------------------|-------------------------------------------------------------------|
| Инженерный ИИ / ML         | Интеграция машинного обучения с FEA крайне редка                  |
| Быстрый анализ конструкций | ML позволяет мгновенно предсказывать результаты расчёта           |
| Инверсные задачи           | Возможность подбора параметров по результату (например, частотам) |
| Модульность                | Проект легко настраивается и масштабируется                       |
| Open-source альтернатива   | Отсутствие зависимости от закрытых систем                         |
| Образование и наука        | Уникальная обучающая и исследовательская платформа                |

---

## Сравнение с существующими решениями

| Возможность / Особенность            | Ansys / KOMPAS и др. | Данный проект                             |
|--------------------------------------|----------------------|-------------------------------------------|
| Открытая реализация алгоритмов       | Закрытые ядра        | Полный доступ к исходному коду            |
| Интеграция с ML                      | Почти нет            | Полноценный модуль машинного обучения     |
| Инверсные задачи (обратный FEA)      | Сложно               | Реализуются через нейросети / оптимизацию |
| Кастомизация и модификация           | Ограничена           | Полностью настраиваемая архитектура       |
| Модульность (CAD → Mesh → FEA → ML)  | Монолитные решения   | Чётко разделённые модули                  |
| Стоимость                            | Дорогие лицензии     | Бесплатно и open-source                   |
| Образовательная ценность             | Ограниченная         | Идеально для изучения FEA/ML/CAD          |

---

## Примеры применения

| Сфера применения             | Как помогает проект                          |
|------------------------------|----------------------------------------------|
| Проектирование конструкций   | Быстрый расчет частот и форм колебаний       |
| Исследования и наука         | Гибкая настройка, open-source база           |
| Образование                  | Изучение МКЭ, CAD, машинного обучения        |
| Инженерный ИИ                | ML-модели для предсказаний и оптимизации     |
| Прототипирование             | База для разработки MVP и цифровых двойников |

---

## 🔬 Уникальные особенности

- **Связка CAD → Mesh → FEA → ML**
- Решение **обратных задач** (по частотам → параметры)
- Возможность **обучать модели ML** на си

## 🚀 Будущее развитие
- Оптимизация конструкций с помощью ML.
- Нелинейный динамический анализ.
- Виброизоляция и демпфирующие системы.
- Сейсмостойкий анализ реальных сооружений.

## Входные данные

CAD-модель в формате:
- `.step` / `.stp`
- (опционально) `.iges`

Пример выходного json файла можно посмотреть в ./materials/data-sample

Проект состоит из функционально разделённых частей.